<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PHOTONOIR - 2026</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;600;800&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    
    <style>
        :root { --bg-color: #E0E0E0; --ink-color: #000; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            background-color: var(--bg-color); color: var(--ink-color);
            font-family: 'Manrope', sans-serif;
            display: flex; justify-content: center; align-items: flex-start;
            height: 100vh; height: 100dvh; 
            margin: 0; overflow: hidden; position: relative;
        }

        /* --- BACKGROUND --- */
        .overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; overflow: hidden; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(0,0,0,0.15) 100%); }
        
        /* Hiệu ứng Film xước & Nhiễu hạt */
        .film-layer { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 100; overflow: hidden; opacity: 0.5; }
        .grain { position: absolute; width: 100%; height: 100%; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.2'/%3E%3C/svg%3E"); animation: grainFlicker 0.2s steps(2) infinite; }
        .scratches { position: absolute; width: 200%; height: 200%; top: -50%; left: -50%; background: repeating-linear-gradient(90deg, transparent 0, transparent 2px, rgba(0,0,0,0.05) 3px, transparent 4px); animation: scratchJump 0.3s steps(1) infinite; opacity: 0.3; }
        @keyframes grainFlicker { 0% { transform: translate(0,0); } 100% { transform: translate(2px, 2px); } }
        @keyframes scratchJump { 0% { transform: translateX(0); } 50% { transform: translateX(10%); } 100% { transform: translateX(-5%); } }

        /* --- BỐ CỤC CHÍNH --- */
        .container {
            width: 100%; max-width: 480px; height: 100%; 
            display: flex; flex-direction: column; 
            justify-content: flex-start; /* Dồn lên trên */
            align-items: center; z-index: 2; 
            padding: env(safe-area-inset-top) 20px 20px;
        }

        /* --- 1. LOGO --- */
        .logo-wrapper {
            width: 100%;
            display: flex; justify-content: center; align-items: flex-start;
            flex-shrink: 0;
            z-index: 10;
            margin-top: -5px; 
            margin-bottom: 0;
        }

        .logo-img { 
            width: 95%; max-width: 420px; height: auto; object-fit: contain; 
            filter: contrast(1.3) drop-shadow(0 8px 12px rgba(0,0,0,0.15)); 
        }

        /* --- 2. KHỐI GIỮA (ĐĨA + CHỮ) --- */
        .center-content {
            display: flex; flex-direction: column; 
            justify-content: flex-start; align-items: center;
            width: 100%;
            /* Kéo sát lên trên */
            margin-top: -70px; 
            position: relative; z-index: 5;
        }

        .vinyl-container {
            position: relative;
            width: 65vmin; height: 65vmin; 
            max-width: 320px; max-height: 320px;
            display: flex; justify-content: center; align-items: center;
            transition: transform 0.1s;
            margin-bottom: 15px; 
        }
        .vinyl-container:active { transform: scale(0.97); }

        /* --- SỬA LẠI TEXTURE ĐĨA THAN --- */
        .vinyl-record {
            width: 100%; height: 100%;
            border-radius: 50%;
            background-color: #101010;
            box-shadow: 0 15px 40px rgba(0,0,0,0.5);
            /* Tăng độ tương phản của vân đĩa để rõ nét hơn */
            background: repeating-radial-gradient(
                #050505 0, 
                #050505 2px, 
                #333 3px, 
                #050505 4px
            );
            position: relative;
        }
        
        /* Hiệu ứng bóng sáng phản chiếu (Glossy) */
        .vinyl-record::after {
            content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 50%;
            /* Tạo vệt sáng chéo nhẹ nhàng, không che mất vân đĩa */
            background: linear-gradient(135deg, 
                rgba(255,255,255,0) 30%, 
                rgba(255,255,255,0.1) 50%, 
                rgba(255,255,255,0) 70%
            );
            pointer-events: none;
        }

        /* Class xoay đĩa - Dùng !important để ưu tiên */
        .spinning-anim { animation: spin 8s linear infinite !important; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .vinyl-label {
            position: absolute; top: 34%; left: 34%; width: 32%; height: 32%;
            background-color: #f0f0f0; border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            border: 1px solid #aaa; z-index: 5;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.1);
        }
        .spindle { width: 8px; height: 8px; background: #000; border-radius: 50%; position: absolute; z-index: 10; }

        /* --- TEXT --- */
        .message-area { 
            width: 100%; text-align: center; padding: 0 10px;
            display: flex; flex-direction: column; gap: 5px; 
            height: 85px; justify-content: flex-start; flex-shrink: 0;
        }
        
        .wishes-text { 
            font-size: 15px; font-weight: 800; line-height: 1.35; 
            color: #000; text-transform: uppercase; letter-spacing: 0px; 
            transition: opacity 0.3s;
            display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;
        }

        .meta-text { 
            font-size: 10px; color: #555; letter-spacing: 2px; 
            font-weight: 700; text-transform: uppercase; opacity: 0.7;
        }
        
        .breathing { animation: breathe 3s ease-in-out infinite; }
        @keyframes breathe { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }
        .glitch { animation: glitch-anim 0.3s both; color: #000; }

        /* --- 3. PLAYER --- */
        .player-wrapper { 
            width: 100%; padding: 0 20px; flex-shrink: 0;
            margin-top: 15px; 
        }
        .player-controls { width: 100%; opacity: 0; transition: opacity 0.5s; padding-bottom: 5px; }
        .has-played .player-controls { opacity: 1; }
        .progress-bar-bg { width: 100%; height: 6px; background: rgba(0,0,0,0.1); border-radius: 3px; overflow: hidden; }
        .progress-bar-fill { width: 0%; height: 100%; background: #000; transition: width 0.1s linear; }
        .time-display { display: flex; justify-content: space-between; margin-top: 8px; font-size: 11px; font-weight: 700; color: #000; font-family: monospace; }
        .visitor-counter { font-size: 10px; color: #666; letter-spacing: 1px; text-transform: uppercase; font-weight: 700; margin-top: 10px; display: flex; gap: 5px; justify-content: center; }
        #busuanzi_container_site_pv { display: none; }

        /* Mũi tên chỉ dẫn */
        .scroll-hint {
            position: absolute; bottom: 20px; width: 100%; text-align: center;
            font-size: 10px; letter-spacing: 2px; text-transform: uppercase; opacity: 0.5;
            animation: float 2s infinite; cursor: pointer;
        }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(5px); } }

        /* --- MÀN HÌNH 2: THƯ CẢM ƠN --- */
        .screen-letter {
            width: 100%; max-width: 480px; margin: 0 auto;
            position: relative; z-index: 2;
            padding: 80px 30px 120px;
            background: linear-gradient(180deg, rgba(224,224,224,0) 0%, rgba(245,245,245,0.95) 15%, #F5F5F5 100%);
        }
        .letter-container { border-left: 2px solid #000; padding-left: 25px; }
        .letter-header { font-family: 'Manrope', sans-serif; font-weight: 800; font-size: 12px; letter-spacing: 3px; text-transform: uppercase; margin-bottom: 30px; opacity: 0.5; }
        .letter-body { font-family: 'Playfair Display', serif; font-size: 18px; line-height: 1.8; color: #111; font-weight: 400; }
        .letter-body p { margin-bottom: 25px; }
        .letter-body p:first-child::first-letter { font-size: 3.5em; float: left; line-height: 0.8; margin-right: 10px; font-weight: 600; }
        .letter-sign { margin-top: 50px; font-family: 'Manrope', sans-serif; font-weight: 700; font-size: 14px; text-transform: uppercase; letter-spacing: 1px; border-top: 1px solid #ccc; display: inline-block; padding-top: 10px; }

        /* --- MOBILE OPTIMIZATION --- */
        @media (max-width: 380px) or (max-height: 700px) {
            .logo-img { width: 95%; }
            .vinyl-container { width: 58vmin; height: 58vmin; margin-bottom: 10px; }
            .wishes-text { font-size: 14px; }
            .player-wrapper { margin-top: 10px; }
            .message-area { height: 80px; }
            .center-content { margin-top: -50px; }
        }
    </style>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</head>
<body>

    <div class="film-layer">
        <div class="grain"></div>
        <div class="scratches"></div>
    </div>

    <div class="screen-hero">
        <div class="logo-wrapper">
            <img src="logo.png" alt="PHOTONOIR" class="logo-img">
        </div>

        <div class="center-content">
            <div class="vinyl-container" onclick="handleInteraction()">
                <div class="vinyl-record" id="record"></div>
                <div class="vinyl-label" id="label"><div class="spindle"></div></div>
            </div>

            <div class="message-area">
                <div class="wishes-text breathing" id="display-text">CHẠM ĐỂ TÌM TẦN SỐ CỦA BẠN</div>
                <div class="meta-text" id="meta-text">2026 COLLECTION</div>
            </div>
        </div>

        <div class="player-wrapper">
            <div class="player-controls">
                <div class="progress-bar-bg"><div class="progress-bar-fill" id="progressFill"></div></div>
                <div class="time-display">
                    <span id="currentTime">0:00</span>
                    <span id="totalTime">--:--</span>
                </div>
            </div>
            <div class="visitor-counter"><span>TOTAL PLAYS:</span><span id="busuanzi_container_site_pv" style="display: inline;"><span id="busuanzi_value_site_pv">...</span></span></div>
        </div>

        <div class="scroll-hint" onclick="scrollToLetter()">↓ SCROLL TO READ</div>
    </div>

    <div class="screen-letter" id="letterSection">
        <div class="letter-container">
            <div class="letter-header">A LETTER FROM PHOTONOIR</div>
            <div class="letter-body">
                <p>Năm vừa qua là một thước phim dài với đầy đủ những gam màu sáng tối. Cảm ơn bạn đã ghé thăm trạm dừng chân nhỏ bé này, đã để âm nhạc và những thước phim của PhotoNoir len lỏi vào một góc cảm xúc của bạn.</p>
                <p>Chúng tôi tin rằng, mỗi khoảnh khắc bạn dừng lại nơi đây, dù chỉ là vài giây hay trọn vẹn một bản nhạc, đều là một sự kết nối vô hình nhưng đầy trân quý.</p>
                <p>Hành trình 2026 đang mở ra. Chúc bạn luôn giữ được "tần số" rực rỡ nhất của riêng mình. Hãy sống như một thước phim — đậm chất, tự do và đầy kiêu hãnh.</p>
            </div>
            <div class="letter-sign">The PhotoNoir Team.</div>
        </div>
    </div>

    <audio id="bgMusic"></audio>

    <script>
        const audio = document.getElementById('bgMusic');
        const record = document.getElementById('record');
        const label = document.getElementById('label');
        const displayText = document.getElementById('display-text');
        const metaText = document.getElementById('meta-text');
        const progressFill = document.getElementById('progressFill');
        const currentTimeEl = document.getElementById('currentTime');
        const totalTimeEl = document.getElementById('totalTime');
        const letterSection = document.getElementById('letterSection');

        const tracks = [
            { id: 1, wish: "TRACK 01: KHỞI ĐẦU RỰC RỠ & ĐẦY KIÊU HÃNH.", song: "Sunroof - Nicky Youre", file: "track1.mp3" },
            { id: 2, wish: "TRACK 02: SỐNG TRỌN TỪNG KHOẢNH KHẮC ĐIỆN ẢNH.", song: "Golden Hour - JVKE", file: "track2.mp3" },
            { id: 3, wish: "TRACK 03: OUT NÉT NỖI BUỒN, LẤY NÉT NIỀM VUI.", song: "Shake It Off - Taylor Swift", file: "track3.mp3" },
            { id: 4, wish: "TRACK 04: DÁM LÀM NHỮNG ĐIỀU CHƯA TỪNG DÁM.", song: "The Nights - Avicii", file: "track4.mp3" },
            { id: 5, wish: "TRACK 05: TỎA SÁNG THEO CÁCH RIÊNG CỦA BẠN.", song: "Diamonds - Rihanna", file: "track5.mp3" },
            { id: 6, wish: "TRACK 06: TÌM THẤY KẾT NỐI CHÂN THẬT NHẤT.", song: "Until I Found You", file: "track6.mp3" },
            { id: 7, wish: "BONUS TRACK: VOUCHER 20% (CHỤP MÀN HÌNH NGAY!)", song: "Money - Lisa", file: "track7.mp3" },
            { id: 8, wish: "TRACK 08: BẢN NHẠC HAY NHẤT ĐỜI BẠN.", song: "Best Day Of My Life", file: "track8.mp3" },
            { id: 9, wish: "TRACK 09: YÊU BẢN THÂN NHIỀU HƠN MỘT CHÚT.", song: "Flowers - Miley Cyrus", file: "track9.mp3" }
        ];

        const STORAGE_KEY = 'photonoir_tracklist_v15';
        let isPlaying = false;
        let userTrack = null;

        window.onload = function() {
            const savedIndex = localStorage.getItem(STORAGE_KEY);
            if (savedIndex !== null) {
                userTrack = tracks[parseInt(savedIndex)];
                setTrackInfo(userTrack);
                displayText.classList.remove('breathing');
                displayText.classList.add('glitch');
                document.querySelector('.player-controls').parentElement.classList.add('has-played');
            }
        };

        function handleInteraction() {
            if (isPlaying) {
                pauseMusic();
            } else {
                playMusic();
            }
        }

        function playMusic() {
            record.classList.add('spinning-anim');
            label.classList.add('spinning-anim');
            isPlaying = true;
            if (userTrack) {
                audio.src = userTrack.file;
                audio.play();
                document.querySelector('.player-controls').parentElement.classList.add('has-played');
            } else {
                startShuffle();
            }
        }

        function pauseMusic() {
            audio.pause();
            record.classList.remove('spinning-anim');
            label.classList.remove('spinning-anim');
            isPlaying = false;
        }

        function startShuffle() {
            displayText.classList.remove('breathing');
            metaText.innerText = "SCANNING FREQUENCY...";
            let count = 0; let speed = 50; let maxCount = 40;
            function step() {
                const randomItem = tracks[Math.floor(Math.random() * tracks.length)];
                displayText.innerText = randomItem.wish;
                displayText.style.opacity = 0.6;
                count++;
                if (count < maxCount) {
                    speed += (count > 30) ? 15 : 2;
                    setTimeout(step, speed);
                } else {
                    finalizeResult();
                }
            }
            step();
        }

        function finalizeResult() {
            const randomIndex = Math.floor(Math.random() * tracks.length);
            userTrack = tracks[randomIndex];
            localStorage.setItem(STORAGE_KEY, randomIndex);
            setTrackInfo(userTrack);
            displayText.style.opacity = 1;
            displayText.classList.add('glitch');
            document.querySelector('.player-controls').parentElement.classList.add('has-played');
            audio.src = userTrack.file;
            audio.play().catch(e => console.log("Interaction needed"));
            if (navigator.vibrate) navigator.vibrate([50, 30, 50]);
        }

        function setTrackInfo(track) {
            displayText.innerText = track.wish;
            metaText.innerText = "NOW PLAYING: " + track.song;
        }

        function scrollToLetter() {
            letterSection.scrollIntoView({ behavior: 'smooth' });
        }

        // Fading Volume Script
        window.addEventListener('scroll', () => {
            if (!isPlaying) return;
            const letterTop = letterSection.getBoundingClientRect().top;
            const windowHeight = window.innerHeight;
            if (letterTop < windowHeight * 0.8) {
                if (audio.volume > 0.2) audio.volume -= 0.05;
            } else {
                if (audio.volume < 1.0) audio.volume += 0.05;
            }
        });

        audio.ontimeupdate = function() {
            if (audio.duration) {
                const percent = (audio.currentTime / audio.duration) * 100;
                progressFill.style.width = percent + '%';
                currentTimeEl.innerText = formatTime(audio.currentTime);
                totalTimeEl.innerText = formatTime(audio.duration);
            }
        };

        audio.onended = function() {
            record.classList.remove('spinning-anim');
            label.classList.remove('spinning-anim');
            isPlaying = false;
            progressFill.style.width = '0%';
        };

        function formatTime(s) {
            if(isNaN(s)) return "0:00";
            const min = Math.floor(s / 60);
            const sec = Math.floor(s % 60);
            return `${min}:${sec<10?'0'+sec:sec}`;
        }
    </script>
</body>
</html>
